2025-01-10T21:10:31.412Z	INFO	bootstrap.auto-configure	directory /root/.kuma will be used as a working directory, it could be changed using KUMA_GENERAL_WORK_DIR environment variable
2025-01-10T21:10:31.532Z	INFO	bootstrap.auto-configure	TLS certificate autogenerated. Autogenerated certificates are not synchronized between CP instances. It is only valid if the data plane proxy connects to the CP by one of the following address dfefb9c5ac72, localhost, 127.0.0.1, 172.19.0.2, ::1. It is recommended to generate your own certificate based on yours trusted CA. You can also generate your own self-signed certificates using 'kumactl generate tls-certificate --type=server --hostname=<hostname>' and configure them using KUMA_GENERAL_TLS_CERT_FILE and KUMA_GENERAL_TLS_KEY_FILE	{"crtFile": "/root/.kuma/kuma-cp.crt", "keyFile": "/root/.kuma/kuma-cp.key"}
2025-01-10T21:10:31.533Z	INFO	plugins.resources.memory	kuma-cp runs with an in-memory database and its state isn't preserved between restarts. Keep in mind that an in-memory database cannot be used with multiple instances of the control plane.
2025-01-10T21:10:31.533Z	INFO	plugin.runtime.gateway	registered gateway plugin
2025-01-10T21:10:31.534Z	INFO	bootstrap	WARNING: you can access Control Plane API as admin by sending requests from the same machine where Control Plane runs. To increase security, it is recommended to extract admin credentials and set KUMA_API_SERVER_AUTHN_LOCALHOST_IS_ADMIN to false.
2025-01-10T21:10:31.540Z	INFO	kuma-cp.run	Current config {"access":{"static":{"adminResources":{"groups":["mesh-system:admin"],"users":["mesh-system:admin"]},"controlPlaneMetadata":{"groups":["mesh-system:unauthenticated","mesh-system:authenticated"],"users":[]},"generateDpToken":{"groups":["mesh-system:admin"],"users":["mesh-system:admin"]},"generateUserToken":{"groups":["mesh-system:admin"],"users":["mesh-system:admin"]},"generateZoneToken":{"groups":["mesh-system:admin"],"users":["mesh-system:admin"]},"viewClusters":{"groups":["mesh-system:unauthenticated","mesh-system:authenticated"],"users":[]},"viewConfigDump":{"groups":["mesh-system:unauthenticated","mesh-system:authenticated"],"users":[]},"viewStats":{"groups":["mesh-system:unauthenticated","mesh-system:authenticated"],"users":[]}},"type":"static"},"apiServer":{"auth":{"clientCertsDir":""},"authn":{"localhostIsAdmin":true,"tokens":{"bootstrapAdminToken":true,"enableIssuer":true,"validator":{"publicKeys":[],"useSecrets":true}},"type":"tokens"},"basePath":"/","corsAllowedDomains":[".*"],"gui":{"basePath":"/gui","enabled":true,"rootUrl":""},"http":{"enabled":true,"interface":"0.0.0.0","port":5681},"https":{"enabled":true,"interface":"0.0.0.0","port":5682,"requireClientCert":false,"tlsCaFile":"","tlsCertFile":"/root/.kuma/kuma-cp.crt","tlsCipherSuites":[],"tlsKeyFile":"/root/.kuma/kuma-cp.key","tlsMaxVersion":"","tlsMinVersion":"TLSv1_2"},"readOnly":false,"rootUrl":""},"bootstrapServer":{"params":{"adminAccessLogPath":"/dev/null","adminAddress":"127.0.0.1","adminPort":9901,"corefileTemplatePath":"","xdsConnectTimeout":"1s","xdsHost":"","xdsPort":5678}},"coreResources":{"enabled":["hostnamegenerators","meshexternalservices","meshmultizoneservices","meshservices"],"status":{"meshMultiZoneServiceInterval":"5s","meshServiceInterval":"5s"}},"defaults":{"SkipHostnameGenerators":false,"createMeshRoutingResources":false,"skipMeshCreation":false,"skipTenantResources":false},"diagnostics":{"debugEndpoints":false,"serverPort":5680,"tlsCertFile":"/root/.kuma/kuma-cp.crt","tlsCipherSuites":[],"tlsEnabled":false,"tlsKeyFile":"/root/.kuma/kuma-cp.key","tlsMaxVersion":"","tlsMinVersion":"TLSv1_2"},"dnsServer":{"CIDR":"240.0.0.0/4","domain":"mesh","serviceVipEnabled":true,"serviceVipPort":80},"dpServer":{"authn":{"dpProxy":{"dpToken":{"enableIssuer":true,"validator":{"publicKeys":[],"useSecrets":true}},"type":"dpToken"},"enableReloadableTokens":false,"zoneProxy":{"type":"zoneToken","zoneToken":{"enableIssuer":true,"validator":{"publicKeys":[],"useSecrets":true}}}},"hds":{"checkDefaults":{"healthyThreshold":1,"interval":"1s","noTrafficInterval":"1s","timeout":"2s","unhealthyThreshold":1},"enabled":true,"interval":"5s","refreshInterval":"10s"},"port":5678,"readHeaderTimeout":"5s","tlsCertFile":"/root/.kuma/kuma-cp.crt","tlsCipherSuites":[],"tlsKeyFile":"/root/.kuma/kuma-cp.key","tlsMaxVersion":"","tlsMinVersion":"TLSv1_2"},"environment":"universal","eventBus":{"bufferSize":100},"experimental":{"autoReachableServices":false,"generateMeshServices":false,"ingressTagFilters":[],"kdsEventBasedWatchdog":{"delayFullResync":false,"enabled":false,"flushInterval":"5s","fullResyncInterval":"1m0s"},"kubeOutboundsAsVIPs":true,"sidecarContainers":false,"skipPersistedVIPs":false,"useTagFirstVirtualOutboundModel":false},"general":{"dnsCacheTTL":"10s","resilientComponentBaseBackoff":"5s","resilientComponentMaxBackoff":"1m0s","tlsCertFile":"/root/.kuma/kuma-cp.crt","tlsCipherSuites":[],"tlsKeyFile":"/root/.kuma/kuma-cp.key","tlsMaxVersion":"","tlsMinVersion":"TLSv1_2","workDir":"/root/.kuma"},"interCp":{"catalog":{"heartbeatInterval":"5s","instanceAddress":"","writerInterval":"15s"},"server":{"port":5683,"tlsCipherSuites":[],"tlsMaxVersion":"","tlsMinVersion":"TLSv1_2"}},"ipam":{"allocationInterval":"5s","meshExternalService":{"cidr":"242.0.0.0/8"},"meshMultiZoneService":{"cidr":"243.0.0.0/8"},"meshService":{"cidr":"241.0.0.0/8"}},"meshService":{"deletionGracePeriod":"1h0m0s","generationInterval":"2s"},"metrics":{"controlPlane":{"reportResourcesCount":true},"dataplane":{"idleTimeout":"5m0s","subscriptionLimit":2},"mesh":{"bufferSize":1000,"eventProcessors":1,"fullResyncInterval":"20s","maxResyncTimeout":"0s","minResyncInterval":"1s","minResyncTimeout":"0s"},"zone":{"compactFinishedSubscriptions":false,"idleTimeout":"5m0s","subscriptionLimit":10}},"mode":"zone","monitoringAssignmentServer":{"apiVersions":["v1"],"assignmentRefreshInterval":"1s","defaultFetchTimeout":"30s","port":5676,"tlsCertFile":"/root/.kuma/kuma-cp.crt","tlsCipherSuites":[],"tlsEnabled":false,"tlsKeyFile":"/root/.kuma/kuma-cp.key","tlsMaxVersion":"","tlsMinVersion":"TLSv1_2"},"multizone":{"global":{"kds":{"grpcPort":5685,"maxMsgSize":10485760,"msgSendTimeout":"1m0s","nackBackoff":"5s","refreshInterval":"1s","responseBackoff":"0s","tlsCertFile":"/root/.kuma/kuma-cp.crt","tlsCipherSuites":[],"tlsEnabled":true,"tlsKeyFile":"/root/.kuma/kuma-cp.key","tlsMaxVersion":"","tlsMinVersion":"TLSv1_2","zoneHealthCheck":{"pollInterval":"0s","timeout":"0s"},"zoneInsightFlushInterval":"10s"}},"zone":{"ingressUpdateInterval":"1s","kds":{"maxMsgSize":10485760,"msgSendTimeout":"1m0s","nackBackoff":"5s","refreshInterval":"1s","responseBackoff":"0s","rootCaFile":"","tlsSkipVerify":false},"name":"default"}},"policies":{"pluginPoliciesEnabled":["meshaccesslogs","meshcircuitbreakers","meshfaultinjections","meshhealthchecks","meshhttproutes","meshloadbalancingstrategies","meshmetrics","meshpassthroughs","meshproxypatches","meshratelimits","meshretries","meshtcproutes","meshtimeouts","meshtlses","meshtraces","meshtrafficpermissions"]},"proxy":{"gateway":{"globalDownstreamMaxConnections":50000}},"reports":{"enabled":false},"runtime":{"kubernetes":{"admissionServer":{"address":"","certDir":"","port":5443},"clientConfig":{"burstQps":100,"qps":100},"controlPlaneServiceName":"kuma-control-plane","controllersConcurrency":{"podController":10},"injector":{"applicationProbeProxyPort":9001,"builtinDNS":{"enabled":true,"port":15053},"caCertFile":"","cniEnabled":false,"containerPatches":[],"ebpf":{"bpffsPath":"/sys/fs/bpf","cgroupPath":"/sys/fs/cgroup","enabled":false,"instanceIPEnvVarName":"INSTANCE_IP","programsSourcePath":"/tmp/kuma-ebpf"},"exceptions":{"labels":{"openshift.io/build.name":"*","openshift.io/deployer-pod-for.name":"*"}},"ignoredServiceSelectorLabels":[],"initContainer":{"image":"kuma/kuma-init:latest"},"nodeLabelsToCopy":["topology.kubernetes.io/zone","topology.kubernetes.io/region","kubernetes.io/hostname"],"sidecarContainer":{"drainTime":"30s","envVars":{},"gid":5678,"image":"kuma/kuma-dp:latest","ipFamilyMode":"dualstack","livenessProbe":{"failureThreshold":12,"initialDelaySeconds":60,"periodSeconds":5,"timeoutSeconds":3},"readinessProbe":{"failureThreshold":12,"initialDelaySeconds":1,"periodSeconds":5,"successThreshold":1,"timeoutSeconds":3},"redirectPortInbound":15006,"redirectPortOutbound":15001,"resources":{"limits":{"cpu":"1000m","memory":"512Mi"},"requests":{"cpu":"50m","memory":"64Mi"}},"startupProbe":{"failureThreshold":12,"initialDelaySeconds":1,"periodSeconds":5,"timeoutSeconds":3},"uid":5678,"waitForDataplaneReady":false},"sidecarTraffic":{"excludeInboundIPs":[],"excludeInboundPorts":[],"excludeOutboundIPs":[],"excludeOutboundPorts":[]},"transparentProxyConfigMap":"","virtualProbesEnabled":true,"virtualProbesPort":9000},"leaderElection":{"leaseDuration":"15s","renewDeadline":"10s"},"marshalingCacheExpirationTime":"5m0s","nodeTaintController":{"cniApp":"","cniNamespace":"kube-system","enabled":false},"serviceAccountName":"system:serviceaccount:kuma-system:kuma-control-plane","skipMeshOwnerReference":false,"supportGatewaySecretsInAllNamespaces":false},"universal":{"dataplaneCleanupAge":"72h0m0s","vipRefreshInterval":"500ms"}},"store":{"cache":{"enabled":true,"expirationTime":"1s"},"kubernetes":{"systemNamespace":"kuma-system"},"postgres":{"connectionTimeout":5,"dbName":"kuma","driverName":"pgx","healthCheckInterval":"30s","host":"127.0.0.1","maxConnectionIdleTime":"30m0s","maxConnectionLifetime":"1h0m0s","maxConnectionLifetimeJitter":"1m0s","maxIdleConnections":50,"maxListQueryElements":0,"maxOpenConnections":50,"minOpenConnections":0,"password":"*****","port":15432,"readReplica":{"host":"","port":5432,"ratio":100},"tls":{"caPath":"","certPath":"","disableSSLSNI":false,"keyPath":"","mode":"disable"},"user":"kuma"},"type":"memory","unsafeDelete":false,"upsert":{"conflictRetryBaseBackoff":"200ms","conflictRetryJitterPercent":30,"conflictRetryMaxTimes":10}},"tracing":{"openTelemetry":{}},"xdsServer":{"dataplaneConfigurationRefreshInterval":"1s","dataplaneDeregistrationDelay":"10s","dataplaneStatusFlushInterval":"10s","nackBackoff":"5s"}}
2025-01-10T21:10:31.540Z	INFO	kuma-cp.run	Running in mode `zone`
2025-01-10T21:10:31.540Z	INFO	mads-server	MADS v1 is enabled
2025-01-10T21:10:31.541Z	INFO	xds.server	registering Aggregated Discovery Service V3 in Dataplane Server
2025-01-10T21:10:31.541Z	INFO	xds.bootstrap	registering Bootstrap in Dataplane Server
2025-01-10T21:10:31.541Z	INFO	hds-server	registering Health Discovery Service in Dataplane Server
2025-01-10T21:10:31.558Z	INFO	kuma-cp.run	starting Control Plane	{"version": "2.9.2"}
2025-01-10T21:10:31.559Z	INFO	mads-server	starting server	{"tls": false, "interface": ":5676"}
2025-01-10T21:10:31.559Z	INFO	bootstrap	leader acquired
2025-01-10T21:10:31.559Z	INFO	hostnamegenerator	starting resilient component ...
2025-01-10T21:10:31.559Z	INFO	plugins.authn.api-server.tokens	Admin User Token not found. Generating.
2025-01-10T21:10:31.559Z	INFO	dns-vips-allocator	starting the DNS VIPs allocator
2025-01-10T21:10:31.559Z	INFO	meshservice.status-updater	starting resilient component ...
2025-01-10T21:10:31.559Z	INFO	xds-server.diagnostics	starting server	{"tls": false, "interface": ":5680"}
2025-01-10T21:10:31.559Z	INFO	meshmultizoneservice.status-updater	starting resilient component ...
2025-01-10T21:10:31.559Z	INFO	mesh-insight-resyncer	starting resilient component ...
2025-01-10T21:10:31.559Z	INFO	clusterID	creating cluster ID	{"clusterID": "d3bf7334-0ef0-4040-a92c-596a61600c17"}
2025-01-10T21:10:31.559Z	INFO	api-server	starting server	{"tls": false, "interface": "0.0.0.0:5681"}
2025-01-10T21:10:31.560Z	INFO	metrics.store-counter	starting the resource counter
2025-01-10T21:10:31.560Z	INFO	dataplane-gc	started
2025-01-10T21:10:31.560Z	INFO	finalizer	started
2025-01-10T21:10:31.560Z	INFO	dp-server	starting	{"interface": "0.0.0.0", "port": 5678, "tls": true}
2025-01-10T21:10:31.560Z	INFO	api-server	starting server	{"tls": true, "interface": "0.0.0.0:5682"}
2025-01-10T21:10:31.560Z	INFO	vips.allocator	starting resilient component ...
2025-01-10T21:10:31.561Z	INFO	intercp.catalog.writer	starting catalog writer
2025-01-10T21:10:31.561Z	INFO	intercp.catalog.writer	replacing a leader in the catalog
2025-01-10T21:10:31.561Z	INFO	zone.components	starting resilient component ...
2025-01-10T21:10:31.561Z	INFO	meshservice.generator	starting resilient component ...
2025-01-10T21:10:31.561Z	INFO	meshservice.generator	starting
2025-01-10T21:10:31.561Z	INFO	zone.components	starting
2025-01-10T21:10:31.737Z	INFO	defaults	Envoy Admin CA created
2025-01-10T21:10:31.737Z	INFO	defaults	Zone resource created	{"name": "default"}
2025-01-10T21:10:31.738Z	INFO	defaults.mesh	ensuring default resources for Mesh exist	{"mesh": "default"}
2025-01-10T21:10:31.758Z	INFO	inter-cp.defaults	Inter CP CA created
2025-01-10T21:10:31.807Z	INFO	defaults.mesh	default Dataplane Token Signing Key created	{"mesh": "default", "name": "dataplane-token-signing-key-default-1"}
2025-01-10T21:10:31.808Z	INFO	defaults.mesh	default MeshTimeout created	{"mesh": "default", "name": "mesh-gateways-timeout-all-default"}
2025-01-10T21:10:31.808Z	INFO	defaults.mesh	default MeshTimeout created	{"mesh": "default", "name": "mesh-timeout-all-default"}
2025-01-10T21:10:31.808Z	INFO	defaults.mesh	default MeshCircuitBreaker created	{"mesh": "default", "name": "mesh-circuit-breaker-all-default"}
2025-01-10T21:10:31.809Z	INFO	defaults.mesh	default MeshRetry created	{"mesh": "default", "name": "mesh-retry-all-default"}
2025-01-10T21:10:31.809Z	INFO	defaults	default Mesh created
2025-01-10T21:10:32.155Z	INFO	defaults	default signing key created	{"prefix": "zone-token-signing-key"}
2025-01-10T21:10:32.156Z	INFO	defaults	hostname generator created	{"name": "local-mesh-external-service"}
2025-01-10T21:10:32.156Z	INFO	defaults	hostname generator created	{"name": "local-universal-mesh-service"}
2025-01-10T21:10:32.312Z	INFO	defaults	default signing key created	{"prefix": "user-token-signing-key"}
2025-01-10T21:10:32.560Z	INFO	clusterID	setting cluster ID	{"clusterID": "d3bf7334-0ef0-4040-a92c-596a61600c17"}
2025-01-10T21:10:32.562Z	INFO	plugins.authn.api-server.tokens	saving generated Admin User Token	{"globalSecretName": "admin-user-token"}
2025-01-10T21:10:32.563Z	INFO	plugins.authn.api-server.tokens	bootstrap of Admin User Token is enabled. To extract admin credentials execute 'curl http://localhost:5681/global-secrets/admin-user-token | jq -r .data | base64 -d'. You configure kumactl with them 'kumactl config control-planes add --auth-type=tokens --auth-conf token=YOUR_TOKEN'. To disable bootstrap of Admin User Token set KUMA_API_SERVER_AUTHN_TOKENS_BOOTSTRAP_ADMIN_TOKEN to false.
2025-01-10T21:10:32.767Z	INFO	intercp.catalog.heartbeat	starting heartbeats to a leader
2025-01-10T21:10:32.767Z	INFO	intercp-server	starting	{"instanceId": "dfefb9c5ac72-c54c", "interface": "0.0.0.0", "port": 5683, "tls": true}
2025-01-10T21:10:32.941Z	INFO	vips.allocator	starting
2025-01-10T21:10:33.036Z	INFO	meshservice.status-updater	starting
2025-01-10T21:10:33.487Z	INFO	meshmultizoneservice.status-updater	starting
2025-01-10T21:10:34.869Z	INFO	hostnamegenerator	starting
